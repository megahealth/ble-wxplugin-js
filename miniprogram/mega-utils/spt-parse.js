"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toInt=toInt,exports.calculate=calculate,exports.base64ToBinarry=base64ToBinarry,exports.calculate_1=calculate_1,exports.cutArray=cutArray;var _index=require("../npm/@tarojs/taro-weapp/index.js"),_index2=_interopRequireDefault(_index);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function toInt(e){return 255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24}function calculate(e){var r=base64ToBinarry(e);console.log(r);for(var t,a=[],n=[],o=!0,l=0;l<r.length;l+=256)for(var s=l+256>=r.length?r.length:l+256,i=r.slice(l,s),u=0,f=0,c=0;c<i.length;c++){var p=255&i[c];if(205==p)u++;else if(239==p)u=0,f++;else if(0==p)u=0;else if(4===u){if(o){var h=[],v=0;for(l=c-8;l<c-4;l++)h[v++]=i[l];t=toInt(h),o=!1}if(0!=p){var g=15&p;0!=(128&p)&&a.push(g)}}else if(4===f)for(v=c;v<i.length-8;v+=8){var y,_;if(0===i[v])break;y=[i[v],i[v+1],i[v+2],i[v+3]],_=[i[v+4],i[v+5],i[v+6],i[v+7]];var d={start:toInt(y),end:toInt(_)};n.push(d),f=0}else f=u=0}return console.log("sptStartTime:"+t),console.log(JSON.stringify(a)),console.log(JSON.stringify(n)),{sptStartTime:t,sptData:a,sptShakeData:n}}function base64ToBinarry(e){var r=Array.from(new Uint8Array(_index2.default.base64ToArrayBuffer(e)));return r&&4<r.length&&"0,0,0"===r.slice(1,4).toString()?r.slice(4):r}function calculate_1(e){for(var r,t=[],a=[],n=[],o=cutArray(base64ToBinarry(e)),l=0;l<o.length;l++){var s,i=o[l];if(205===i[4]&&205===i[5]&&205===i[6]&&205===i[7]){s=i[0]|i[1]<<8|i[2]<<16|i[3]<<24,0===l&&(r=s);for(var u=8;u<i.length-48;u++){var f=i[u];f>>7==1?(t.push(15&f),0!=(f>>4&8)?n.push(f>>4&7):n.push(-1)):console.log("无效")}}}for(var c=0;c<n.length;c++){var p=0;if(0<n[c])for(var h=r+c;;c++){if(n[c]<=0||c===n.length-1){a.push({start:h,end:1e3*(r+c),total:p,level:n[c-1]});break}p++}}return{sptStartTime:r,sptData:t,sptShakeData:a}}function cutArray(e){for(var r=[],t=0;t<e.length;t+=256)r.push(e.slice(t,t+256));return r}